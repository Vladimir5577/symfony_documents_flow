<script>
    (function () {
        var input = document.getElementById('phone-column');
        if (!input) return;

        function formatPhone(value) {
            var digits = value.replace(/\D/g, '');
            if (digits.charAt(0) === '8') digits = '7' + digits.slice(1);
            if (digits.charAt(0) !== '7') digits = '7' + digits;
            digits = digits.slice(0, 11);
            if (digits.length <= 1) return digits === '7' ? '+7' : '+7';
            var s = '+7 (' + digits.slice(1, 4);
            if (digits.length > 4) s += ') ' + digits.slice(4, 7);
            if (digits.length > 7) s += ' ' + digits.slice(7, 9);
            if (digits.length > 9) s += ' ' + digits.slice(9, 11);
            return s;
        }

        function onPhoneInput() {
            var start = input.selectionStart, oldLen = input.value.length, oldVal = input.value;
            input.value = formatPhone(input.value);
            var newLen = input.value.length;
            var newStart = Math.max(0, start + (newLen - oldLen));
            if (input === document.activeElement) input.setSelectionRange(newStart, newStart);
        }

        input.addEventListener('input', onPhoneInput);
        input.addEventListener('paste', function () { setTimeout(onPhoneInput, 0); });
        if (input.value) input.value = formatPhone(input.value);
    })();
</script>
